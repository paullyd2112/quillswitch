<!DOCTYPE html>
<html>
<head>
    <title>QuillSwitch Security Score</title>
    <script type="module">
        // Import and run security audit
        import { securityAuditor } from '/src/utils/securityAudit.ts';
        
        console.log('Getting security score...');
        
        try {
            const result = await securityAuditor.performComprehensiveAudit();
            
            // Display results in a clean format
            document.body.innerHTML = `
                <div style="font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px;">
                    <h1>üõ°Ô∏è Security Score Report</h1>
                    
                    <div style="background: ${result.score >= 85 ? '#10B981' : result.score >= 70 ? '#F59E0B' : '#EF4444'}; 
                                color: white; padding: 20px; border-radius: 8px; margin: 20px 0;">
                        <h2 style="margin: 0; font-size: 2.5em;">${result.score}/100</h2>
                        <p style="margin: 5px 0; font-size: 1.2em;">
                            Status: ${result.compliant ? '‚úÖ COMPLIANT' : '‚ùå NON-COMPLIANT'}
                        </p>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 6px;">
                            <h3 style="margin-top: 0; color: #dc3545;">Issues Found</h3>
                            <p style="font-size: 1.5em; margin: 0;">${result.issues.length}</p>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 6px;">
                            <h3 style="margin-top: 0; color: #007bff;">Recommendations</h3>
                            <p style="font-size: 1.5em; margin: 0;">${result.recommendations.length}</p>
                        </div>
                    </div>
                    
                    ${result.issues.length > 0 ? `
                        <h3>üö® Security Issues</h3>
                        <div style="margin-bottom: 20px;">
                            ${result.issues.map(issue => `
                                <div style="border-left: 4px solid ${
                                    issue.severity === 'critical' ? '#dc3545' : 
                                    issue.severity === 'high' ? '#fd7e14' : 
                                    issue.severity === 'medium' ? '#ffc107' : '#28a745'
                                }; padding: 15px; margin: 10px 0; background: #f8f9fa;">
                                    <h4 style="margin: 0 0 10px 0; color: #333;">
                                        ${issue.severity.toUpperCase()}: ${issue.title}
                                    </h4>
                                    <p style="margin: 5px 0; color: #666;">${issue.description}</p>
                                    <p style="margin: 5px 0; color: #495057;"><strong>Fix:</strong> ${issue.remediation}</p>
                                </div>
                            `).join('')}
                        </div>
                    ` : '<p style="color: #28a745; font-weight: bold;">‚úÖ No security issues found!</p>'}
                    
                    <h3>üí° Security Recommendations</h3>
                    <div>
                        ${result.recommendations.map(rec => `
                            <div style="border: 1px solid #dee2e6; padding: 15px; margin: 10px 0; border-radius: 6px;">
                                <h4 style="margin: 0 0 10px 0; color: #007bff;">${rec.title}</h4>
                                <p style="margin: 5px 0; color: #666;">${rec.description}</p>
                                <p style="margin: 5px 0; color: #495057;"><strong>Implementation:</strong> ${rec.implementation}</p>
                                <p style="margin: 5px 0; color: #6c757d;"><strong>Effort:</strong> ${rec.estimatedEffort}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
        } catch (error) {
            console.error('Security audit failed:', error);
            document.body.innerHTML = `
                <div style="font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px;">
                    <h1>‚ùå Security Audit Failed</h1>
                    <p>Error: ${error.message}</p>
                </div>
            `;
        }
    </script>
</head>
<body>
    <div style="font-family: Arial, sans-serif; text-align: center; padding: 50px;">
        <h1>üîç Running Security Audit...</h1>
        <p>Please wait while we analyze your application's security posture.</p>
    </div>
</body>
</html>