<!DOCTYPE html>
<html>
<head>
    <title>QuillSwitch Security Check</title>
    <script type="module">
        // Run security audit and display results
        import { securityAuditor } from '/src/utils/securityAudit.ts';
        
        console.log('üîí Running security audit...');
        
        try {
            const result = await securityAuditor.performComprehensiveAudit();
            
            console.log('=== SECURITY AUDIT RESULTS ===');
            console.log(`üìä Security Score: ${result.score}/100`);
            console.log(`‚úÖ Compliant: ${result.compliant ? 'YES' : 'NO'}`);
            console.log(`‚ö†Ô∏è Issues Found: ${result.issues.length}`);
            console.log(`üí° Recommendations: ${result.recommendations.length}`);
            
            if (result.issues.length > 0) {
                console.log('\nüö® Security Issues:');
                result.issues.forEach(issue => {
                    console.log(`- [${issue.severity.toUpperCase()}] ${issue.title}: ${issue.description}`);
                });
            }
            
            // Display results on page
            document.body.innerHTML = `
                <div style="font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto;">
                    <h1>üîí QuillSwitch Security Rating</h1>
                    <div style="background: ${result.score >= 85 ? '#d4edda' : result.score >= 70 ? '#fff3cd' : '#f8d7da'}; 
                                padding: 20px; border-radius: 8px; margin: 20px 0;">
                        <h2 style="margin: 0; color: ${result.score >= 85 ? '#155724' : result.score >= 70 ? '#856404' : '#721c24'};">
                            Security Score: ${result.score}/100
                        </h2>
                        <p style="margin: 10px 0 0 0; color: ${result.score >= 85 ? '#155724' : result.score >= 70 ? '#856404' : '#721c24'};">
                            Status: ${result.compliant ? 'COMPLIANT' : 'NON-COMPLIANT'}
                        </p>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                            <h3>üö® Issues: ${result.issues.length}</h3>
                            ${result.issues.map(issue => `
                                <div style="margin: 10px 0; padding: 10px; background: white; border-radius: 4px;">
                                    <strong>[${issue.severity.toUpperCase()}]</strong> ${issue.title}<br>
                                    <small style="color: #666;">${issue.description}</small>
                                </div>
                            `).join('')}
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                            <h3>üí° Recommendations: ${result.recommendations.length}</h3>
                            ${result.recommendations.slice(0, 3).map(rec => `
                                <div style="margin: 10px 0; padding: 10px; background: white; border-radius: 4px;">
                                    <strong>[${rec.priority.toUpperCase()}]</strong> ${rec.title}<br>
                                    <small style="color: #666;">${rec.description}</small>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    <p style="color: #666; font-size: 14px; margin-top: 30px;">
                        Audit completed: ${new Date().toLocaleString()}
                    </p>
                </div>
            `;
            
        } catch (error) {
            console.error('‚ùå Security audit failed:', error);
            document.body.innerHTML = `
                <div style="font-family: Arial, sans-serif; padding: 20px; text-align: center;">
                    <h1>‚ö†Ô∏è Security Audit Failed</h1>
                    <p>Unable to complete security assessment. Check the console for details.</p>
                    <pre style="background: #f8f9fa; padding: 15px; text-align: left; border-radius: 8px;">
                        ${error.message || error}
                    </pre>
                </div>
            `;
        }
    </script>
</head>
<body>
    <div style="font-family: Arial, sans-serif; padding: 20px; text-align: center;">
        <h1>üîí Running Security Audit...</h1>
        <p>Please wait while we assess your application's security posture.</p>
    </div>
</body>
</html>